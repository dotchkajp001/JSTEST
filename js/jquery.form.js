(function(b){b.fn.ajaxSubmit=function(l){if(!this.length){a("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof l=="function"){l={success:l}}l=b.extend({url:this.attr("action")||window.location.toString(),type:this.attr("method")||"GET"},l||{});var o={};this.trigger("form-pre-serialize",[this,l,o]);if(o.veto){a("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(l.beforeSerialize&&l.beforeSerialize(this,l)===false){a("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var g=this.formToArray(l.semantic);if(l.data){l.extraData=l.data;for(var d in l.data){if(l.data[d] instanceof Array){for(var e in l.data[d]){g.push({name:d,value:l.data[d][e]})}}else{g.push({name:d,value:l.data[d]})}}}if(l.beforeSubmit&&l.beforeSubmit(g,this,l)===false){a("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[g,this,l,o]);if(o.veto){a("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var c=b.param(g);if(l.type.toUpperCase()=="GET"){l.url+=(l.url.indexOf("?")>=0?"&":"?")+c;l.data=null}else{l.data=c}var m=this,f=[];if(l.resetForm){f.push(function(){m.resetForm()})}if(l.clearForm){f.push(function(){m.clearForm()})}if(!l.dataType&&l.target){var i=l.success||function(){};f.push(function(k){b(l.target).html(k).each(i,arguments)})}else{if(l.success){f.push(l.success)}}l.success=function(q,n){for(var p=0,k=f.length;p<k;p++){f[p].apply(l,[q,n,m])}};var j=b("input:file",this).length>0?true:false;if(l.iframe||j){if(l.closeKeepAlive){b.get(l.closeKeepAlive,h)}else{h()}}else{b.ajax(l)}this.trigger("form-submit-notify",[this,l]);return this;function h(){var t=m[0];if(b(":input[name=submit]",t).length){alert('Error: Form elements must not be named "submit".');return}var q=b.extend({},b.ajaxSettings,l);var D=jQuery.extend(true,{},b.extend(true,{},b.ajaxSettings),q);var r="jqFormIO"+(new Date().getTime());var z=b('<iframe id="'+r+'" name="'+r+'" src="about:blank" />');var B=z[0];z.css({position:"absolute",top:"-1000px",left:"-1000px"});var C={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;z.attr("src","about:blank")}};var A=q.global;if(A&&!b.active++){b.event.trigger("ajaxStart")}if(A){b.event.trigger("ajaxSend",[C,q])}if(D.beforeSend&&D.beforeSend(C,D)===false){D.global&&jQuery.active--;return}if(C.aborted){return}var p=0;var v=0;var k=t.clk;if(k){var u=k.name;if(u&&!k.disabled){l.extraData=l.extraData||{};l.extraData[u]=k.value;if(k.type=="image"){l.extraData[name+".x"]=t.clk_x;l.extraData[name+".y"]=t.clk_y}}}setTimeout(function(){var F=m.attr("target"),s=m.attr("action");t.setAttribute("target",r);if(t.getAttribute("method")!="POST"){t.setAttribute("method","POST")}if(t.getAttribute("action")!=q.url){t.setAttribute("action",q.url)}if(!l.skipEncodingOverride){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(q.timeout){setTimeout(function(){v=true;w()},q.timeout)}var E=[];try{if(l.extraData){for(var G in l.extraData){E.push(b('<input type="hidden" name="'+G+'" value="'+l.extraData[G]+'" />').appendTo(t)[0])}}z.appendTo("body");B.attachEvent?B.attachEvent("onload",w):B.addEventListener("load",w,false);t.submit()}finally{t.setAttribute("action",s);F?t.setAttribute("target",F):m.removeAttr("target");b(E).remove()}},10);var x=0;function w(){if(p++){return}B.detachEvent?B.detachEvent("onload",w):B.removeEventListener("load",w,false);var s=true;try{if(v){throw"timeout"}var E,G;G=B.contentWindow?B.contentWindow.document:B.contentDocument?B.contentDocument:B.document;if((G.body==null||G.body.innerHTML=="")&&!x){x=1;p--;setTimeout(w,100);return}C.responseText=G.body?G.body.innerHTML:null;C.responseXML=G.XMLDocument?G.XMLDocument:G;C.getResponseHeader=function(I){var H={"content-type":q.dataType};return H[I]};if(q.dataType=="json"||q.dataType=="script"){var n=G.getElementsByTagName("textarea")[0];C.responseText=n?n.value:C.responseText}else{if(q.dataType=="xml"&&!C.responseXML&&C.responseText!=null){C.responseXML=y(C.responseText)}}E=b.httpData(C,q.dataType)}catch(F){s=false;b.handleError(q,C,"error",F)}if(s){q.success(E,"success");if(A){b.event.trigger("ajaxSuccess",[C,q])}}if(A){b.event.trigger("ajaxComplete",[C,q])}if(A&&!--b.active){b.event.trigger("ajaxStop")}if(q.complete){q.complete(C,s?"success":"error")}setTimeout(function(){z.remove();C.responseXML=null},100)}function y(n,E){if(window.ActiveXObject){E=new ActiveXObject("Microsoft.XMLDOM");E.async="false";E.loadXML(n)}else{E=(new DOMParser()).parseFromString(n,"text/xml")}return(E&&E.documentElement&&E.documentElement.tagName!="parsererror")?E:null}}};b.fn.ajaxForm=function(c){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){b(this).ajaxSubmit(c);return false}).each(function(){b(":submit,input:image",this).bind("click.form-plugin",function(f){var d=this.form;d.clk=this;if(this.type=="image"){if(f.offsetX!=undefined){d.clk_x=f.offsetX;d.clk_y=f.offsetY}else{if(typeof b.fn.offset=="function"){var g=b(this).offset();d.clk_x=f.pageX-g.left;d.clk_y=f.pageY-g.top}else{d.clk_x=f.pageX-this.offsetLeft;d.clk_y=f.pageY-this.offsetTop}}}setTimeout(function(){d.clk=d.clk_x=d.clk_y=null},10)})})};b.fn.ajaxFormUnbind=function(){this.unbind("submit.form-plugin");return this.each(function(){b(":submit,input:image",this).unbind("click.form-plugin")})};b.fn.formToArray=function(q){var p=[];if(this.length==0){return p}var d=this[0];var h=q?d.getElementsByTagName("*"):d.elements;if(!h){return p}for(var k=0,m=h.length;k<m;k++){var e=h[k];var f=e.name;if(!f){continue}if(q&&d.clk&&e.type=="image"){if(!e.disabled&&d.clk==e){p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}continue}var r=b.fieldValue(e,true);if(r&&r.constructor==Array){for(var g=0,c=r.length;g<c;g++){p.push({name:f,value:r[g]})}}else{if(r!==null&&typeof r!="undefined"){p.push({name:f,value:r})}}}if(!q&&d.clk){var l=d.getElementsByTagName("input");for(var k=0,m=l.length;k<m;k++){var o=l[k];var f=o.name;if(f&&!o.disabled&&o.type=="image"&&d.clk==o){p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}}}return p};b.fn.formSerialize=function(c){return b.param(this.formToArray(c))};b.fn.fieldSerialize=function(d){var c=[];this.each(function(){var h=this.name;if(!h){return}var f=b.fieldValue(this,d);if(f&&f.constructor==Array){for(var g=0,e=f.length;g<e;g++){c.push({name:h,value:f[g]})}}else{if(f!==null&&typeof f!="undefined"){c.push({name:this.name,value:f})}}});return b.param(c)};b.fn.fieldValue=function(h){for(var g=[],e=0,c=this.length;e<c;e++){var f=this[e];var d=b.fieldValue(f,h);if(d===null||typeof d=="undefined"||(d.constructor==Array&&!d.length)){continue}d.constructor==Array?b.merge(g,d):g.push(d)}return g};b.fieldValue=function(c,j){var e=c.name,p=c.type,q=c.tagName.toLowerCase();if(typeof j=="undefined"){j=true}if(j&&(!e||c.disabled||p=="reset"||p=="button"||(p=="checkbox"||p=="radio")&&!c.checked||(p=="submit"||p=="image")&&c.form&&c.form.clk!=c||q=="select"&&c.selectedIndex==-1)){return null}if(q=="select"){var k=c.selectedIndex;if(k<0){return null}var m=[],d=c.options;var g=(p=="select-one");var l=(g?k+1:d.length);for(var f=(g?k:0);f<l;f++){var h=d[f];if(h.selected){var o=h.value;if(!o){o=(h.attributes&&h.attributes.value&&!(h.attributes.value.specified))?h.text:h.value}if(g){return o}m.push(o)}}return m}return c.value};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var d=this.type,c=this.tagName.toLowerCase();if(d=="text"||d=="password"||c=="textarea"){this.value=""}else{if(d=="checkbox"||d=="radio"){this.checked=false}else{if(c=="select"){this.selectedIndex=-1}}}})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};b.fn.enable=function(c){if(c==undefined){c=true}return this.each(function(){this.disabled=!c})};b.fn.selected=function(c){if(c==undefined){c=true}return this.each(function(){var d=this.type;if(d=="checkbox"||d=="radio"){this.checked=c}else{if(this.tagName.toLowerCase()=="option"){var e=b(this).parent("select");if(c&&e[0]&&e[0].type=="select-one"){e.find("option").selected(false)}this.selected=c}}})};function a(){if(b.fn.ajaxSubmit.debug&&window.console&&window.console.log){window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}}})(jQuery);